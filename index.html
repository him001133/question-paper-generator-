<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Question Paper Log Form</title>
</head>
<body>
  <h2>Save Question Paper Record</h2>
  <form id="paperForm">
    <label>Paper Type:</label>
    <select id="paperType">
      <option>Half Yearly</option>
      <option>Final Year</option>
      <option>Practice Worksheet</option>
    </select>
    <br><br>

    <label>Class:</label>
    <select id="classSelect">
      <option>6</option>
      <option>7</option>
      <option>8</option>
      <option>9</option>
      <option>10</option>
    </select>
    <br><br>

    <label>Subject:</label>
    <select id="subject">
      <option>SST</option>
      <option>Maths</option>
      <option>Science</option>
      <option>Hindi</option>
      <option>English</option>
    </select>
    <br><br>

    <label>Chapters:</label><br>
    <textarea id="chapters" rows="4" cols="40"></textarea>
    <br><br>

    <label>Duration:</label>
    <select id="duration">
      <option>10</option>
      <option>20</option>
      <option>30</option>
      <option>60</option>
      <option>90</option>
    </select>
    <br><br>

    <button type="submit">Save Record</button>
  </form>

  <script>
    const repoOwner = "him001133";
    const repoName = "question-paper-generator";
    const token = "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 "; // ⚠️ Store securely in backend, not frontend!

    document.getElementById("paperForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      const paperType = document.getElementById("paperType").value;
      const classVal = document.getElementById("classSelect").value;
      const subject = document.getElementById("subject").value;
      const chapters = document.getElementById("chapters").value;
      const duration = document.getElementById("duration").value;

      const logData = 
`Paper Type: ${paperType};
Class: ${classVal};
Subject: ${subject};
Chapters: ${chapters};
Duration: ${duration};

`;

      const fileName = `logs/${Date.now()}_record.txt`;  // unique file per entry

      const response = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${fileName}`, {
        method: "PUT",
        headers: {
          "Authorization": `token ${token}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          message: "New paper log added",
          content: btoa(unescape(encodeURIComponent(logData))) // base64 encoding
        })
      });

      if (response.ok) {
        alert("Record saved to GitHub!");
      } else {
        const err = await response.json();
        alert("Error: " + JSON.stringify(err));
      }
    });
  </script>
</body>
</html>
